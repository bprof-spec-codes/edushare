<div class="card-container">
    <div class="card-background">
        <div class="isrecommended" *ngIf="m.isRecommended"><i class="bi bi-pin-angle-fill fs-3  position-absolute "></i>
        </div>
        
        <br>
        <div class=" options-menu dropdown ms-3" *ngIf="authService.isAdmin()">
            <button class="btn btn-link text-dark p-0" type="button" id="optionsMenu" data-bs-toggle="dropdown"
              aria-expanded="false">
              <i class="bi bi-three-dots-vertical fs-5"></i>
            </button>

            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="optionsMenu">
              <li>
                <button class="dropdown-item text-danger" (click)="deleteMaterial()">
                  <i class="bi bi-trash me-2"></i> Törlés
                </button>
              </li>
            </ul>
        </div>
        <div [class]="titleClass()" *ngIf="m.uploader.image.file">{{m.title}}</div>
        <div class="datas">
            <div *ngIf="m.isExam" class="examClass">
                <i class="examIcon bi bi-exclamation-diamond me-2"></i><div class="isexam">Exam material</div>
            </div>
            <div class="icon-data">
                <i class="bi bi-book book"></i>
                <button class="subject" (click)="openSubjectMaterials(m.subject.id)">{{m.subject.name}}</button>
            </div>
            
            <div class="icon-data">
                <img *ngIf="m.uploader.image.file" [src]="m.uploader.image.file.startsWith('http')
                            ? m.uploader.image.file
                            : 'data:image/*;base64,' + m.uploader.image.file" [alt]="m.uploader.fullName"
                    class="profile-pic" width="21" height="21" />
                <div class="btn-profile-container">
                    <button class="btn-profile" (click)="openProfile(m.uploader.id)">{{m.uploader.fullName}}</button>
                </div>
            </div>
            <div class="icon-data">
                <i class="bi bi-clock clock"></i>
                <div class="date">{{m.uploadDate | date:'yyyy.MM.dd'}}</div>
            </div>
        </div>
        <div class="open-bookmark">
            <button class="open-button" (click)="openMaterial(m)" [style]="isLoggedIn ? 'width: 65%' : 'width: 190px'">Open</button>
            <button type="button" class="btn-bookmark" (click)="toggleFavourite()" *ngIf="isLoggedIn"
                [attr.aria-pressed]="((isFav$ | async) ?? false) ? 'true' : 'false'">

                <ng-container [ngSwitch]="(isFav$ | async) ?? false">
                    <svg *ngSwitchCase="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                        fill="currentColor" class="bi bi-bookmark icon-bookmark" viewBox="0 0 16 16">
                        <path
                            d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1z" />
                    </svg>

                    <svg *ngSwitchCase="true" xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                        fill="currentColor" class="bi bi-bookmark-fill icon-bookmark" viewBox="0 0 16 16">
                        <path d="M2 2v13.5l6-3.25 6 3.25V2a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2z" />
                    </svg>
                </ng-container>
            </button>
        </div>
    </div>
</div>
